<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <link rel="icon" href="/favicon.ico" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#000000" />
  <title>Video Diary Emotion</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto%3A700"/>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Outfit%3A600%2C700"/>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro%3A600%2C700"/>
  <link rel="stylesheet" href="./styles/video-diary-emotion.css"/>
</head>
<body>
<div class="video-diary-emotion-42V">
  <div class="group-33025-nz5">
    <div class="rectangle-81-kvu">
    </div>
    <div class="group-33007-g3s">
      <div class="logobottom-R1T">
        <img class="mask-group-NhP" src="./assets/mask-group-SRF.png"/>
        <p class="mental-mastery-iWM">mental mastery</p>
      </div>
      <div class="auto-group-sqho-c5w">
        <div class="navtop-jAZ">
          <p class="home-rW5">Home</p>
          <p class="about-PW1">About</p>
          <p class="feature-vkq">Feature</p>
        </div>
        <div class="contactusbutton-sAH">CONTACT US</div>
      </div>
    </div>
  </div>
  <div class="auto-group-wt8m-Kny">
    <div class="group-33033-4Em">
      <div class="your-entrys-emotion-analysis-pDw">Your entryâ€™s emotion analysis</div>
      <div class="group-33032-sxu">
        <div class="group-33030-q93">preview</div>
        <div class="auto-group-omzr-iCq">emotion analysis result</div>
      </div>
    </div>
    <img class="vector-1-mS1" src="./assets/vector-1-vTT.png"/>
  </div>
</div>
</body>

<script>
  window.onload = function() {
  // Get the success message from localStorage
  const message = localStorage.getItem('message');

  // Remove the success message from localStorage
  localStorage.removeItem('message');

  if (message) {
    // Display the success message
    alert(message);
  }

    // Get the video URL from localStorage
    const videoURL = localStorage.getItem('videoURL');

    // Remove the video URL from localStorage
    localStorage.removeItem('videoURL');

    if (videoURL) {
      // Create a video element for the recorded video
      const recordedVideo = document.createElement('video');
      recordedVideo.src = videoURL;
      recordedVideo.controls = true;
      recordedVideo.load();

      // Insert the recorded video element into group-33030-q93
      const previewContainer = document.querySelector('.group-33030-q93');
      previewContainer.innerHTML = ''; // Clear the container
      previewContainer.appendChild(recordedVideo); // Append the video element
    }
  };

  // sending request to Face API
  const faceAPIUrl = 'https://[location].api.cognitive.microsoft.com/face/v1.0/detect'; //replace location
  const params = {
    'returnFaceId': 'true',
    'returnFaceLandmarks': 'false',
    'returnFaceAttributes': 'emotion',
  };

  fetch(`${faceAPIUrl}?${new URLSearchParams(params)}`, {
    method: 'POST',
    body: blob, // The Blob or ArrayBuffer of the frame
    headers: {
      'Content-Type': 'application/octet-stream',
      'Ocp-Apim-Subscription-Key': '[your_face_api_subscription_key]', //insert subscription key here
    },
  })
  .then(response => response.json())
  .then(data => {
    console.log(data);
    // Extract the emotion data and add it to the list of detected emotions
  })
  .catch(error => console.error(error));

  //display detected emotion (replace starting from script beginning)
//   window.onload = function() {
//   // Get the video URL from localStorage
//   const videoURL = localStorage.getItem('videoURL');

//   // Remove the video URL from localStorage
//   localStorage.removeItem('videoURL');

//   if (videoURL) {
//     // Create a video element for the recorded video
//     const recordedVideo = document.createElement('video');
//     recordedVideo.src = videoURL;
//     recordedVideo.controls = true;
//     recordedVideo.load();

//     // Insert the recorded video element into group-33030-q93
//     const previewContainer = document.querySelector('.group-33030-q93');
//     previewContainer.innerHTML = ''; // Clear the container
//     previewContainer.appendChild(recordedVideo); // Append the video element

//     // Get the emotions from localStorage
//     const emotions = JSON.parse(localStorage.getItem('emotions'));

//     // Remove the emotions from localStorage
//     localStorage.removeItem('emotions');

//     if (emotions) {
//       // Display the emotions
//       const emotionsContainer = document.createElement('div');
//       emotionsContainer.textContent = JSON.stringify(emotions, null, 2);
//       previewContainer.appendChild(emotionsContainer);
//     }
//   }
// };
</script>
